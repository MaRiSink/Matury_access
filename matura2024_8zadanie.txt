--Zadanie 8.1
SELECT
    Kierowcy.Imie,
    Kierowcy.Nazwisko,
    SUM(Taryfikator.Kwota)
FROM
    (
        Rejestr
        INNER JOIN Kierowcy ON Kierowcy.IdOsoby = Rejestr.IdOsoby
    )
    INNER JOIN Taryfikator ON Rejestr.IdWykroczenia = Taryfikator.IdWykroczenia
GROUP BY
    Kierowcy.Imie,
    Kierowcy.Nazwisko
ORDER BY
    SUM(Taryfikator.Kwota) DESC





--Zadanie 8.2
SELECT
    Month(Rejestr.Data) AS [Najmniej],
    SUM(Taryfikator.Punkty)
FROM
    (
        Rejestr
        INNER JOIN Kierowcy ON Kierowcy.IdOsoby = Rejestr.IdOsoby
    )
    INNER JOIN Taryfikator ON Rejestr.IdWykroczenia = Taryfikator.IdWykroczenia
WHERE
    Taryfikator.IdWykroczenia BETWEEN 3 AND 6
GROUP BY
    Month(Rejestr.Data)
ORDER BY
    SUM(Taryfikator.Punkty);



--Zadanie 8.3
SELECT
    Kierowcy.Imie,
    Kierowcy.Nazwisko,
    Kierowcy.NrRejestracyjny
FROM
    Kierowcy
WHERE
    Kierowcy.IdOsoby NOT IN (
        SELECT
            Kierowcy.IdOsoby
        FROM
            Kierowcy
            INNER JOIN Rejestr ON Kierowcy.IdOsoby = Rejestr.IdOsoby
    )
ORDER BY
    Kierowcy.NrRejestracyjny;






--Zadanie 8.4
SELECT
    Fotoradar.idFotoradaru
FROM
    Fotoradar
WHERE
    Fotoradar.idFotoradaru NOT IN (
        SELECT
            Fotoradar.idFotoradaru
        FROM
            Fotoradar
            INNER JOIN Rejestr ON Fotoradar.idFotoradaru = Rejestr.idFotoradaru
    );